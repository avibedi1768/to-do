<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>to-do</title>
	<link rel="stylesheet" href="style.css">
	<link rel="icon" type="image/x-icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQoEhTRgvXkLwNSkdpzmZwk7cwrf65C_3QmPTmfLI2_pOwJ9JsKFovp7jvX3lOoSIbhiMU&usqp=CAU">
</head>
<body onload="loadwala()">
	<h1 style="background-color: rgb(92, 23, 23);color: rgb(181, 210, 236);text-align: center; display:flex;align-items: center;justify-content: center ;">TO-DO</h1>
	<section>
		<div id="take">
			<label for="chore">Enter the chore </label><br>
			<input type="text" id="chore" placeholder="Chore" required><br>
			<label for="desc">Enter some description </label><br>
			<textarea rows="4" id="desc" placeholder="Description" required></textarea>
			<br>
			<button onclick="sendStuff()">Submit</button>
		</div>
	</section>

	<section id="components"></section>

	<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-analytics.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase.js"></script>
	
	<script>
		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
		  apiKey: "AIzaSyDLy3u7BxPWMpAxJqPawtCCcf5Oxx5w_h4",
		  authDomain: "todo-b2fc0.firebaseapp.com",
		  projectId: "todo-b2fc0",
		  storageBucket: "todo-b2fc0.appspot.com",
		  messagingSenderId: "1034880743632",
		  appId: "1:1034880743632:web:4d8b33d74274b19b1346d5",
		  measurementId: "G-VGGGMTGSCH"
		};

		// Initialize Firebase
		  firebase.initializeApp(firebaseConfig);
	  	  firebase.analytics();
	</script>
	
	<script type="text/javascript">
		if (window.localStorage.getItem('id') == undefined) {
			window.localStorage.setItem('id', 0);
		}

		function compo(Desc, Chore){
			if (Desc == "" || Chore == ""){
				window.alert("Please enter some data for the todo");
			}
			else{
				let div = document.createElement("div");
				let head = document.createElement("h1");
				head.innerHTML = Chore;
				let hr = document.createElement("hr");
				let para = document.createElement("p");
				para.innerHTML = Desc;
				var btn = document.createElement("button");
				btn.innerHTML = "Completed!";

				div.append(head, hr, para, btn);
				btn.addEventListener ("click", function() {
					window.alert("button clicked");
				});
				document.getElementById("components").appendChild(div);
			}
		}
		function sendStuff(){
			var db = firebase.database();
			let chore = document.getElementById("chore").value;
			let desc = document.getElementById("desc" ).value;
			compo(desc,chore);

			var id = window.localStorage.getItem('id');
			console.log(id);
			db.ref("component " + id).set({
				chore : chore,
				desc : desc
			})
			db.ref("id/").set({
				id: parseInt(id) + 1
			})
			window.localStorage.setItem('id',parseInt(id) + 1);
			sendToLocal(chore, desc, id);
		}
		function sendToLocal(chore, desc, id) {
			
			window.localStorage.setItem("task" + id, chore);
			window.localStorage.setItem("desc" + id, desc);
		}	
		function loadwala(){
			for(i=0; i<1000; i++){
				if(window.localStorage.getItem("task" + i) == undefined){
					break;
				}
				var Chore = window.localStorage.getItem("task" + i);
				var Desc = window.localStorage.getItem("desc" + i);
				compo(Desc, Chore);
			}
		}
	</script>
</body>
</html>